{# templates/facture/nouvelle_facture.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}Nouvelle Facture{% endblock %}

{% block body %}
<div class="container">
    <form action="/ajouterFacture" method="post">
        <label for="dateReservation">Date de réservation</label>
        <input type="date" id="dateReservation" name="dateReservation" required>
        <br>

        <label for="produitDropdown">Sélectionnez un produit :</label>
        <select id="produitDropdown" name="produitDropdown">
            <option value="" disabled selected>Choisissez un produit</option>

            {% for produit in produits %}
                {# Assurez-vous d'avoir une méthode appropriée dans votre entité Produit pour obtenir le nom et l'ID #}
                <option value="{{ produit.id }}">{{ produit.nom }} {{produit.prixUnitaire}}€</option>
            {% endfor %}
        </select>

        <div id="produitsSelectionnes"></div>
        <div id="total">Total: €</div>

        <button type="submit">Valider</button>
    </form>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var produitDropdown = document.getElementById("produitDropdown");
        var produitsSelectionnes = document.getElementById("produitsSelectionnes");

        // Quand un produit du dropdown est sélectionné
        produitDropdown.addEventListener("change", function () {
            var selectedOption = produitDropdown.options[produitDropdown.selectedIndex];

            if (selectedOption.value !== "") {
                // Crée une div pour le produit sélectionné
                var produitDiv = document.createElement("div");
                produitDiv.innerHTML = selectedOption.text;

                // Ajoute le produit à la div des produits sélectionnés
                produitsSelectionnes.appendChild(produitDiv);

                // Retire le produit du dropdown
                selectedOption.remove();

                // Réinitialise le dropdown pour sélectionner l'option vide
                produitDropdown.selectedIndex = 0;
            }
        });
    });
</script>

</div>
{% endblock %}
